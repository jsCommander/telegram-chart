!function(i){var n={};function h(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,h),e.l=!0,e.exports}h.m=i,h.c=n,h.d=function(t,e,i){h.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},h.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},h.t=function(e,t){if(1&t&&(e=h(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(h.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)h.d(i,n,function(t){return e[t]}.bind(null,n));return i},h.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return h.d(e,"a",e),e},h.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},h.p="",h(h.s=0)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1);window.Chart=n.Chart},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var C,n,w,h,v=i(2),y=i(3);(n=C||(C={}))[n.BEGIN=0]="BEGIN",n[n.END=1]="END",n[n.ALL=2]="ALL",n[n.NONE=3]="NONE",(h=w||(w={}))[h.LEFT=0]="LEFT",h[h.RIGHT=1]="RIGHT";var s=function(){function t(f,t,e){var g=this;this.container=f,this.chartData=t,this.disabledLines={x:!0},this.helperBoxLocation=w.LEFT,this.isDragInProgress=!1,this.dragType=C.NONE,this.grabOffset=0,this.lastSupportLineX=0,this.timestamps=[],this.legendStep=1,this.config=Object.assign({},v.config,e);var i=f.getBoundingClientRect(),u=document.createElement("canvas");u.width=i.width,u.height=i.height,f.appendChild(u),window.addEventListener("resize",function(t){var e=f.getBoundingClientRect();u.width=e.width,u.height=e.height;var i=g.config.margin,n=g.ctx.canvas.width-2*i,h=g.ctx.canvas.height-2*i,s=Math.round(h*g.config.controlViewHeigth);g.controlChartView=new y.Rect(i,h-s+i,n,s);var o=Math.round(h*g.config.legendViewHeigth);g.legendView=new y.Rect(i,g.controlChartView.y-o,n,o),g.mainChartView=new y.Rect(i,i,n,g.legendView.y-i),g.totalPoints=g.chartData.columns[0].length,g.controlChart=g.getChartLines(0,g.totalPoints+1,g.controlChartView);var r=Math.round(g.totalPoints*g.config.selectionDefaultPoints);g.selectionMinPoints=Math.round(g.totalPoints*g.config.selectionMinPoints),g.beginOffset=r,g.endOffset=g.beginOffset+r,g.drawControlChart(),g.grid=g.getGrid(g.mainChartView),g.mainChart=g.getChartLines(g.beginOffset,g.endOffset,g.mainChartView),g.legendFontOffsetX=Math.ceil(.3*g.legendView.height);var a=Math.min(g.legendView.height-g.legendFontOffsetX,16);g.legendFont=a+"px "+g.config.legendFont,g.legendOneItemWidth=g.ctx.measureText(g.timestamps[0]).width+g.legendFontOffsetX,g.helperBoxFontSize=a,g.ctx.font=a+"px "+g.config.helperBoxFont,g.helperBoxFontWidth=g.chartData.columns.reduce(function(t,e){var i=e[0];if("x"===i)return t;var n=g.chartData.names[i].slice(0,3)+g.trimValue(g.controlChart.max);return Math.max(t,g.ctx.measureText(n).width)},0);var l=1.3*g.helperBoxFontWidth,c=a*g.chartData.columns.length*1.2;g.helperBoxOffsetX=Math.round(1.5*g.ctx.measureText(g.trimValue(g.controlChart.max)).width);var d=Math.round(.5*c);g.helperBox=new y.Rect(g.helperBoxOffsetX,d,l,c),g.legendStep=Math.ceil(2*g.legendOneItemWidth/g.mainChart.stepX),g.drawMainChart()});var n=u.getContext("2d");if(!n)throw new Error("Can't get canvas context 2d");this.ctx=n,this.themeName=this.config.defaultTheme,this.theme=v.themes[this.config.defaultTheme];var h={month:"short",day:"2-digit"};this.chartData.columns.forEach(function(t){"x"===t[0]&&(g.timestamps=t.slice(1).map(function(t){return new Date(t).toLocaleDateString("en-US",h)}))});var s=this.config.margin,o=this.ctx.canvas.width-2*s,r=this.ctx.canvas.height-2*s,a=Math.round(r*this.config.controlViewHeigth);this.controlChartView=new y.Rect(s,r-a+s,o,a);var l=Math.round(r*this.config.legendViewHeigth);this.legendView=new y.Rect(s,this.controlChartView.y-l,o,l),this.mainChartView=new y.Rect(s,s,o,this.legendView.y-s),this.totalPoints=this.chartData.columns[0].length,this.controlChart=this.getChartLines(0,this.totalPoints+1,this.controlChartView);var c=Math.round(this.totalPoints*this.config.selectionDefaultPoints);this.selectionMinPoints=Math.round(this.totalPoints*this.config.selectionMinPoints),this.beginOffset=c,this.endOffset=this.beginOffset+c,this.drawControlChart(),this.grid=this.getGrid(this.mainChartView),this.mainChart=this.getChartLines(this.beginOffset,this.endOffset,this.mainChartView),this.legendFontOffsetX=Math.ceil(.3*this.legendView.height);var d=Math.min(this.legendView.height-this.legendFontOffsetX,16);this.legendFont=d+"px "+this.config.legendFont,this.legendOneItemWidth=this.ctx.measureText(this.timestamps[0]).width+this.legendFontOffsetX,this.helperBoxFontSize=d,this.ctx.font=d+"px "+this.config.helperBoxFont,this.helperBoxFontWidth=this.chartData.columns.reduce(function(t,e){var i=e[0];if("x"===i)return t;var n=g.chartData.names[i].slice(0,3)+g.trimValue(g.controlChart.max);return Math.max(t,g.ctx.measureText(n).width)},0);var x=1.3*this.helperBoxFontWidth,m=d*this.chartData.columns.length*1.2;this.helperBoxOffsetX=Math.round(1.5*this.ctx.measureText(this.trimValue(this.controlChart.max)).width);var p=Math.round(.5*m);this.helperBox=new y.Rect(this.helperBoxOffsetX,p,x,m),this.legendStep=Math.ceil(2*this.legendOneItemWidth/this.mainChart.stepX),this.drawMainChart(),this.ctx.canvas.addEventListener("mousemove",function(t){g.mousemoveHandler(t.offsetX,t.offsetY)}),this.ctx.canvas.addEventListener("touchmove",function(t){var e=g.touchToMouse(t);g.mousemoveHandler(e.x,e.y)}),this.ctx.canvas.addEventListener("mousedown",function(t){g.mousedownHandler(t.offsetX,t.offsetY)}),this.ctx.canvas.addEventListener("touchstart",function(t){t.preventDefault();var e=g.touchToMouse(t);g.mousedownHandler(e.x,e.y)}),this.ctx.canvas.addEventListener("mouseup",this.mouseupHandler.bind(this)),this.ctx.canvas.addEventListener("mouseout",this.mouseupHandler.bind(this)),this.ctx.canvas.addEventListener("touchend",this.mouseupHandler.bind(this)),this.ctx.canvas.addEventListener("touchcancel",this.mouseupHandler.bind(this))}return t.prototype.touchToMouse=function(t){var e=this.ctx.canvas.getBoundingClientRect();return{x:t.touches[0].clientX-e.left,y:t.touches[0].clientY-e.top}},t.prototype.mouseupHandler=function(){this.isDragInProgress&&(this.isDragInProgress=!1)},t.prototype.mousedownHandler=function(t,e){this.selectionBox&&this.selectionBox.isPointInRect(t,e)&&(this.isDragInProgress=!0,this.beginRect.isPointInRect(t,e)?this.dragType=C.BEGIN:this.endRect.isPointInRect(t,e)?this.dragType=C.END:this.dragType=C.ALL,this.grabOffset=this.selectionBox.x-t)},t.prototype.mousemoveHandler=function(t,e){if(this.mainChart&&this.controlChart)if(this.isDragInProgress){t=this.dragType===C.ALL?(t+=this.grabOffset,Math.min(t,this.controlChartView.getEndX()-this.selectionBox.width)):Math.min(t,this.controlChartView.getEndX()),t=Math.max(t,this.controlChartView.x);var i=this.findIndexOfClosestValueInSortedArray(t,this.controlChart.cordsX);if(this.dragType===C.BEGIN)this.beginOffset=this.endOffset-i>this.selectionMinPoints?i:this.endOffset-this.selectionMinPoints;else if(this.dragType===C.END)this.endOffset=i-this.beginOffset>this.selectionMinPoints?i:this.beginOffset+this.selectionMinPoints;else{var n=this.endOffset-this.beginOffset;this.beginOffset=i,this.endOffset=this.beginOffset+n}this.drawControlChart(),this.mainChart=this.getChartLines(this.beginOffset,this.endOffset+1,this.mainChartView),this.legendStep=Math.ceil(1.5*this.legendOneItemWidth/this.mainChart.stepX),this.drawMainChart()}else if(this.mainChartView.isPointInRect(t,e)){if(Math.abs(this.lastSupportLineX-t)<this.mainChart.stepX/2)return;this.drawMainChart();i=this.findIndexOfClosestValueInSortedArray(t,this.mainChart.cordsX);this.drawHelper(i),this.lastSupportLineX=this.mainChart.cordsX[i]}},t.prototype.recalculateAll=function(){this.controlChart=this.getChartLines(0,this.totalPoints+1,this.controlChartView),this.mainChart=this.getChartLines(this.beginOffset,this.endOffset+1,this.mainChartView),this.drawControlChart(),this.drawMainChart()},t.prototype.drawMainChart=function(){for(var t in this.clearRect(this.mainChartView),this.drawGrid(),this.ctx.lineWidth=this.config.mainChartLineWidth,this.mainChart.lines)this.mainChart.lines.hasOwnProperty(t)&&(this.ctx.strokeStyle=this.chartData.colors[t],this.ctx.stroke(this.mainChart.lines[t]));this.drawLegend()},t.prototype.drawControlChart=function(){for(var t in this.clearRect(this.controlChartView),this.ctx.lineWidth=this.config.controlChartLineWidth,this.controlChart.lines)this.controlChart.lines.hasOwnProperty(t)&&(this.ctx.strokeStyle=this.chartData.colors[t],this.ctx.stroke(this.controlChart.lines[t]));var e=this.controlChart.cordsX[this.beginOffset],i=this.controlChart.cordsX[this.endOffset];this.selectionBox=new y.Rect(e,this.controlChartView.y,i-e,this.controlChartView.height),this.drawSelection(this.selectionBox)},t.prototype.drawGrid=function(){this.ctx.strokeStyle=this.theme.gridLineColor,this.ctx.fillStyle=this.theme.legendFontColor,this.ctx.lineWidth=this.config.gridLineWidth,this.ctx.stroke(this.grid.path)},t.prototype.drawSelection=function(t){this.ctx.fillStyle=this.theme.unselectedColor,this.ctx.fillRect(this.controlChartView.x,this.controlChartView.y,t.x-this.controlChartView.x,this.controlChartView.height),this.ctx.fillRect(t.getEndX(),this.controlChartView.y,this.controlChartView.getEndX()-t.getEndX(),this.controlChartView.height),this.ctx.fillStyle=this.theme.selectionBoxColor,this.beginRect=new y.Rect(t.x,t.y,this.config.selectionGrabWidth,t.height),this.endRect=new y.Rect(t.getEndX()-this.config.selectionGrabWidth,t.y,this.config.selectionGrabWidth,t.height),this.fillRect(this.beginRect),this.fillRect(this.endRect);var e=Math.ceil(this.config.selectionGrabWidth/5);this.ctx.fillRect(this.beginRect.getEndX(),t.y,this.endRect.x-this.beginRect.getEndX(),e),this.ctx.fillRect(this.beginRect.getEndX(),t.getEndY()-e,this.endRect.x-this.beginRect.getEndX(),e)},t.prototype.drawHelper=function(t){var n=this,h=this.mainChart.cordsX[t],s=this.mainChart.offset+t;this.ctx.lineWidth=this.config.gridLineWidth,this.ctx.strokeStyle=this.theme.gridLineColor,this.ctx.beginPath(),this.ctx.moveTo(h,this.mainChartView.y),this.ctx.lineTo(h,this.mainChartView.getEndY()),this.ctx.stroke();var o=[];this.chartData.columns.forEach(function(t){var e=t[0];if(!n.disabledLines[e]){n.ctx.lineWidth=n.config.mainChartLineWidth,n.ctx.strokeStyle=n.chartData.colors[e],n.ctx.fillStyle=n.theme.backgroundColor;var i=n.mainChartView.getEndY()-t[s]*n.mainChart.scaleY;n.ctx.moveTo(h,i),n.ctx.beginPath(),n.ctx.arc(h,i,n.config.chartPointRadius,0,2*Math.PI,!0),n.ctx.fill(),n.ctx.stroke(),o.push({color:n.chartData.colors[e],name:n.chartData.names[e].toString(),value:n.trimValue(t[s])})}}),this.helperBoxLocation===w.LEFT?this.helperBox.getEndX()>h&&(this.helperBoxLocation=w.RIGHT,this.helperBox.x=this.mainChartView.getEndX()-this.helperBoxOffsetX-this.helperBox.width):this.helperBox.x<h&&(this.helperBoxLocation=w.LEFT,this.helperBox.x=this.mainChartView.x+this.helperBoxOffsetX),this.ctx.strokeStyle=this.theme.gridLineColor,this.ctx.fillStyle=this.theme.backgroundColor,this.fillRect(this.helperBox),this.strokeRect(this.helperBox);var i=Math.round(.1*this.helperBox.width);this.ctx.font=this.legendFont,this.ctx.fillStyle="black";var e=this.timestamps[t+this.mainChart.offset-1];this.ctx.fillText(e,this.helperBox.x+i,this.helperBox.y+this.helperBoxFontSize);var r=this.helperBox.y+2*this.helperBoxFontSize;o.forEach(function(t,e){n.ctx.fillStyle=t.color,n.ctx.fillText(t.name.slice(0,4)+":"+t.value,n.helperBox.x+i,r+(n.helperBoxFontSize+2)*e)})},t.prototype.drawLegend=function(){this.clearRect(this.legendView);var t=this.mainChart.max/this.config.gridLineCount;this.ctx.fillStyle=this.theme.legendFontColor,this.ctx.font=this.legendFont;parseInt(this.ctx.font.slice(0,2));for(var e=0;e<this.config.gridLineCount;e++){var i=Math.round(t*e);this.ctx.fillText(this.trimValue(i),this.mainChartView.x+5,this.mainChartView.getEndY()-i*this.mainChart.scaleY-5)}this.ctx.fillStyle=this.theme.legendFontColor;for(e=1;e<this.mainChart.cordsX.length;e+=this.legendStep){i=this.timestamps[this.mainChart.offset+e-1];this.ctx.fillText(i,this.mainChart.cordsX[e],this.legendView.getEndY()-this.legendFontOffsetX)}},t.prototype.fillRect=function(t){this.ctx.fillRect(t.x,t.y,t.width,t.height)},t.prototype.strokeRect=function(t){this.ctx.strokeRect(t.x,t.y,t.width,t.height)},t.prototype.clearRect=function(t){this.ctx.fillStyle=this.theme.backgroundColor,this.ctx.fillRect(t.x,t.y,t.width,t.height)},t.prototype.disableLine=function(t){this.disabledLines[t]=!0,this.recalculateAll()},t.prototype.enableLine=function(t){this.disabledLines[t]=!1,this.recalculateAll()},t.prototype.toggleLine=function(t){this.disabledLines[t]=!this.disabledLines[t],this.recalculateAll()},t.prototype.getGrid=function(t){for(var e=t.height/this.config.gridLineCount,i=new Path2D,n=0;n<this.config.gridLineCount;n++){var h=t.getEndY()-e*n;i.moveTo(t.x,h),i.lineTo(t.getEndX(),h)}return{path:i,stepY:e}},t.prototype.getChartLines=function(s,o,r){var a=this;s=Math.max(1,s+1);var t=(o=Math.min(this.chartData.columns[0].length-1,o+1))-s,e=r.width/(t-1),i=this.findMaxMinValues(s,o),n=i.max,h=i.min;n+=Math.round(.1*n);for(var l=r.height/n,c=[],d=0;d<t;d++)c.push(e*d+r.x);var f={};return this.chartData.columns.forEach(function(t){var e=t[0];if(!a.disabledLines[e]){var i=new Path2D;i.moveTo(r.x,r.getEndY()-t[s]*l);for(var n=s,h=0;n<o;n++,h++)i.lineTo(c[h],r.getEndY()-t[n]*l);f[e]=i}}),{cordsX:c,lines:f,scaleY:l,offset:s,stepX:e,max:n,min:h}},t.prototype.findMaxMinValues=function(n,h){for(var s,o,r=this,t=0;t<this.chartData.columns.length;t++){var e=this.chartData.columns[t][0];if(!this.disabledLines[e]){s=this.chartData.columns[t][1],o=this.chartData.columns[t][1];break}}return this.chartData.columns.forEach(function(t){var e=t[0];if(!r.disabledLines[e])for(var i=n;i<h;i++)t[i]>s&&(s=t[i]),t[i]<o&&(o=t[i])}),{max:s,min:o}},t.prototype.trimValue=function(t){return t<1e3?t.toString():t<1e5?(t/1e3).toFixed(2).toString()+"k":t<1e8?(t/1e6).toFixed(2).toString()+"m":(t/1e8).toFixed(2).toString()+"b"},t.prototype.findIndexOfClosestValueInSortedArray=function(t,e){for(var i=0;e[i]<t;){if(i>e.length-1)return-1;i++}return Math.abs(e[i-1]-t)<Math.abs(e[i]-t)&&(i-=1),i},t}();e.Chart=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.config={margin:0,controlViewHeigth:.2,legendViewHeigth:.05,helperBoxHeight:.25,helperBoxFont:"serif",legendFont:"serif",gridLineCount:6,gridLineWidth:2,mainChartLineWidth:2,controlChartLineWidth:1,chartPointRadius:3,selectionMinPoints:.1,selectionDefaultPoints:.33,selectionGrabWidth:15,defaultTheme:"white"};e.themes={white:{gridLineColor:"#f2f4f5",legendFontColor:"#96a2aa",helperLineColor:"#dfe6eb",backgroundColor:"#ffffff",selectionBoxColor:"#068dda44",unselectedColor:"#f5f9fbdd"},dark:{gridLineColor:"#f2f4f5",legendFontColor:"#96a2aa",helperLineColor:"#dfe6eb",backgroundColor:"#ffffff",selectionBoxColor:"#f5f9fbaa",unselectedColor:"#068dda44"}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n}return t.prototype.getEndX=function(){return this.x+this.width},t.prototype.getEndY=function(){return this.y+this.height},t.prototype.isPointInRect=function(t,e){return this.x<t&&t<this.getEndX()&&this.y<e&&e<this.getEndY()},t}();e.Rect=n}]);